<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Model generation: src/GenerateModel.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="http://www.mathjax.org/mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="transitlogo.png"></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Model generation&#160;<span id="projectnumber">0.5</span></div>
   <div id="projectbrief">Generating synthetic transit lightcurves</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>src/GenerateModel.cpp</h1>  </div>
</div>
<div class="contents">
<a href="_generate_model_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;GenerateModel.h&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;Model.h&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;constants.h&quot;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">using namespace </span>std;
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html">00022</a> <span class="keyword">namespace</span>
<a name="l00023"></a>00023 {
<a name="l00031"></a><a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a69da40f864acfd9c1ddd7f5db4269f50">00031</a>     <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a69da40f864acfd9c1ddd7f5db4269f50" title=" calculator">calcOmega</a>(<span class="keyword">const</span> vector&lt;double&gt; &amp;coeffs)
<a name="l00032"></a>00032     {
<a name="l00033"></a>00033         <span class="keywordtype">double</span> returnval;
<a name="l00034"></a>00034         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;=4; ++n)
<a name="l00035"></a>00035         {
<a name="l00036"></a>00036             returnval += coeffs.at(n) / (n + 4.);
<a name="l00037"></a>00037         }
<a name="l00038"></a>00038         <span class="keywordflow">return</span> returnval;
<a name="l00039"></a>00039     }
<a name="l00040"></a>00040 
<a name="l00048"></a>00048     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00049"></a><a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df">00049</a>     <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(T val) { <span class="keywordflow">return</span> val * val; }
<a name="l00050"></a>00050 
<a name="l00069"></a><a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1">00069</a>     <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a>(<span class="keywordtype">double</span> r, <span class="keywordtype">double</span> c1, <span class="keywordtype">double</span> c2, <span class="keywordtype">double</span> c3, <span class="keywordtype">double</span> c4)
<a name="l00070"></a>00070     {
<a name="l00071"></a>00071         <span class="keywordtype">double</span> rprimed = 1. - <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(r);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073         <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a> = 1.;
<a name="l00074"></a>00074         I -= c1 * (1. - pow(rprimed, 1./4.));
<a name="l00075"></a>00075         I -= c2 * (1. - pow(rprimed, 2./4.));
<a name="l00076"></a>00076         I -= c3 * (1. - pow(rprimed, 3./4.));
<a name="l00077"></a>00077         I -= c4 * (1. - pow(rprimed, 4./4.));
<a name="l00078"></a>00078         <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a>;
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080 
<a name="l00097"></a><a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6e87455ba96b310dd7e480a6ea86e10b">00097</a>     <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a>(<span class="keywordtype">double</span> r, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;coeffs)
<a name="l00098"></a>00098     {
<a name="l00099"></a>00099         <span class="keywordtype">double</span> rprimed = 1. - <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(r);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 
<a name="l00102"></a>00102         <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a> = 1.;
<a name="l00103"></a>00103         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=4; ++i)
<a name="l00104"></a>00104         {
<a name="l00105"></a>00105             <span class="keywordtype">double</span> coeff = coeffs.at(i);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107             I -= coeff * (1. - pow(rprimed, static_cast&lt;double&gt;(i)/4.));
<a name="l00108"></a>00108         }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a>;
<a name="l00112"></a>00112     }
<a name="l00113"></a>00113 
<a name="l00130"></a><a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4f10298cdce44be90967464a1ccb6644">00130</a>     <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4f10298cdce44be90967464a1ccb6644" title="Integrates the intensity in a given range.">IntegratedI</a>(<span class="keywordtype">double</span> dr, <span class="keywordtype">double</span> c1, <span class="keywordtype">double</span> c2, <span class="keywordtype">double</span> c3, <span class="keywordtype">double</span> c4, <span class="keywordtype">double</span> rlow, <span class="keywordtype">double</span> rhigh)
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132         <span class="keywordtype">double</span> sum = 0;
<a name="l00133"></a>00133         <span class="keywordflow">for</span> (<span class="keywordtype">double</span> r=rlow; r&lt;=rhigh; r+=dr)
<a name="l00134"></a>00134         {
<a name="l00135"></a>00135             sum += <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a>(r, c1, c2, c3, c4) * dr * 2. * r;
<a name="l00136"></a>00136         }
<a name="l00137"></a>00137         <span class="keywordflow">return</span> sum;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 
<a name="l00155"></a><a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#aba84809606a6d040ab5e75e32faff089">00155</a>     <span class="keywordtype">double</span> <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4f10298cdce44be90967464a1ccb6644" title="Integrates the intensity in a given range.">IntegratedI</a>(<span class="keywordtype">double</span> dr, <span class="keyword">const</span> std::vector&lt;double&gt; &amp;coeffs, <span class="keywordtype">double</span> rlow, <span class="keywordtype">double</span> rhigh)
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         <span class="keywordtype">double</span> sum = 0;
<a name="l00158"></a>00158         <span class="keywordflow">for</span> (<span class="keywordtype">double</span> r=rlow; r&lt;=rhigh; r+=dr)
<a name="l00159"></a>00159         {
<a name="l00160"></a>00160             sum += <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a6b36a99e72016f594b75c73624fe62f1" title="Intensity at position r.">I</a>(r, coeffs) * dr * 2. * r;
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162         <span class="keywordflow">return</span> sum;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     }
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="_generate_model_8cpp.html#a8fa49227f33a7691948269d2541f31a5">00167</a> vector&lt;double&gt; <a class="code" href="_generate_model_8h.html#af5ed9c485083590880abf3597f7e7bca" title="Calculates a synthetic lightcurve.">GenerateSynthetic</a>(<span class="keyword">const</span> vector&lt;double&gt; &amp;jd, <span class="keyword">const</span> <a class="code" href="struct_model.html" title="Class holding the state of the system.">Model</a> &amp;m)
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169     <span class="comment">/* All values are in normalised units so have to scale always */</span>
<a name="l00170"></a>00170     
<a name="l00171"></a>00171     vector&lt;double&gt; Flux;
<a name="l00172"></a>00172     <span class="keywordtype">double</span> normalisedDistance = m.<a class="code" href="struct_model.html#a18e5ef915d4c3b58c5e81c94ddc89057" title="Orbital separation.">a</a> * AU / (m.<a class="code" href="struct_model.html#a397a88aa23535336f6e8ef3bbe6a75f4" title="Stellar radius.">rs</a> * rSun);
<a name="l00173"></a>00173 <span class="comment">//    cout &lt;&lt; &quot;Normalisation constant: &quot; &lt;&lt; normalisedDistance &lt;&lt; endl;</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="keyword">const</span> <span class="keywordtype">double</span> dr = 0.001;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="comment">/* Package the coefficients into a vector */</span>
<a name="l00178"></a>00178     vector&lt;double&gt; coeffs(5);
<a name="l00179"></a>00179     coeffs[1] = m.<a class="code" href="struct_model.html#ad3fcb7edfaa21c029d4b80e76f7004c0" title="Limb darkening coefficient 1.">c1</a>;
<a name="l00180"></a>00180     coeffs[2] = m.<a class="code" href="struct_model.html#ac08824d28336dd50469a64c686d062e9" title="Limb darkening coefficient 2.">c2</a>;
<a name="l00181"></a>00181     coeffs[3] = m.<a class="code" href="struct_model.html#a824de61da14a58e0c5ed9c6b2b42ef0a" title="Limb darkening coefficient 3.">c3</a>;
<a name="l00182"></a>00182     coeffs[4] = m.<a class="code" href="struct_model.html#a64439281e8e5e35a2dfa1819c4fcde37" title="Limb darkening coefficient 4.">c4</a>;
<a name="l00183"></a>00183     coeffs[0] = 1. - coeffs[1] - coeffs[2] - coeffs[3] - coeffs[4];
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="keywordtype">double</span> omega = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a69da40f864acfd9c1ddd7f5db4269f50" title=" calculator">calcOmega</a>(coeffs);
<a name="l00187"></a>00187     <span class="keywordtype">double</span> angFreq = 2. * M_PI / (m.<a class="code" href="struct_model.html#a864f3b07f3c7e05d19b4f3fb3e35ffe8" title="Orbital period.">period</a> * secondsInDay);
<a name="l00188"></a>00188 <span class="comment">//    cout &lt;&lt; &quot;Angular frequency: &quot; &lt;&lt; angFreq &lt;&lt; &quot; rad per sec&quot; &lt;&lt; endl;</span>
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     <span class="comment">// get the cosine of the inclination</span>
<a name="l00191"></a>00191     <span class="keywordtype">double</span> cosi = cos(m.<a class="code" href="struct_model.html#a5c681ff122dbd7f125cc04c30b0c204f" title="Orbital inclination.">i</a> * radiansInDegree);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193     <span class="keyword">const</span> <span class="keywordtype">double</span> p = (m.<a class="code" href="struct_model.html#ac5b9f58eb8d5e695e78cd9366bd135f0" title="Planetary radius.">rp</a> * rJup) / (m.<a class="code" href="struct_model.html#a397a88aa23535336f6e8ef3bbe6a75f4" title="Stellar radius.">rs</a> * rSun);
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;jd.size(); ++i)
<a name="l00196"></a>00196     {
<a name="l00197"></a>00197         <span class="comment">/* Seconds since epoch */</span>
<a name="l00198"></a>00198         <span class="keywordtype">double</span> t = (jd.at(i) - m.<a class="code" href="struct_model.html#a63fb06adc34ad4e7e1187db2d8ba8afc" title="Epoch.">epoch</a>) * secondsInDay;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         <span class="comment">/* get the normalised device coordinates */</span>
<a name="l00201"></a>00201         <span class="keywordtype">double</span> firstTerm = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(sin(angFreq * t));
<a name="l00202"></a>00202         <span class="keywordtype">double</span> secondTerm = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(cosi * cos(angFreq * t));
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 
<a name="l00207"></a>00207         <span class="keywordtype">double</span> z = normalisedDistance * sqrt(firstTerm + secondTerm);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209         <span class="keywordtype">double</span> intpart;
<a name="l00210"></a>00210         <span class="keywordtype">double</span> phase = fabs(modf(t  / (m.<a class="code" href="struct_model.html#a864f3b07f3c7e05d19b4f3fb3e35ffe8" title="Orbital period.">period</a> * secondsInDay) , &amp;intpart));
<a name="l00211"></a>00211         phase = phase &gt; 0.5 ? phase - 1.0 : phase;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213         <span class="keywordtype">double</span> F = 0;
<a name="l00214"></a>00214 
<a name="l00215"></a>00215         <span class="comment">/* Hack to make sure the secondary eclipse is not created */</span>
<a name="l00216"></a>00216         <span class="keywordflow">if</span> ((phase &gt; -0.25) &amp;&amp; (phase &lt; 0.25))
<a name="l00217"></a>00217         {
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 
<a name="l00220"></a>00220             <span class="keywordflow">if</span> (z &lt;= 1 - p)
<a name="l00221"></a>00221             {
<a name="l00222"></a>00222                 F = 0.;
<a name="l00223"></a>00223                 <span class="comment">//F = 1. - square(p);</span>
<a name="l00224"></a>00224                 <span class="keywordtype">double</span> norm = 1. / (4. * z * p);
<a name="l00225"></a>00225                 <span class="keywordtype">double</span> integral = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4f10298cdce44be90967464a1ccb6644" title="Integrates the intensity in a given range.">IntegratedI</a>(dr, coeffs, z-p, z+p);
<a name="l00226"></a>00226                 integral *= norm;
<a name="l00227"></a>00227                 F = 1. - (<a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(p) * integral / 4. / omega);
<a name="l00228"></a>00228             }
<a name="l00229"></a>00229             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (z &gt; 1 + p)
<a name="l00230"></a>00230             {
<a name="l00231"></a>00231                 F = 1.;
<a name="l00232"></a>00232             }
<a name="l00233"></a>00233             <span class="keywordflow">else</span>
<a name="l00234"></a>00234             {
<a name="l00235"></a>00235                 <span class="keywordtype">double</span> startPoint = z - p;
<a name="l00236"></a>00236                 <span class="keywordtype">double</span> a = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(startPoint);
<a name="l00237"></a>00237                 <span class="keywordtype">double</span> norm = 1./(1 - a);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239                 <span class="comment">/* Integrate the I*(z) function from startPoint to 1 */</span>
<a name="l00240"></a>00240                 <span class="keywordtype">double</span> integral = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4f10298cdce44be90967464a1ccb6644" title="Integrates the intensity in a given range.">IntegratedI</a>(dr, coeffs, startPoint, 1.);
<a name="l00241"></a>00241                 integral *= norm;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243                 <span class="keywordtype">double</span> insideSqrt = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(p) - <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(z - 1.);
<a name="l00244"></a>00244                 <span class="keywordtype">double</span> sqrtVal = sqrt(insideSqrt);
<a name="l00245"></a>00245                 sqrtVal *= (z - 1.);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247                 <span class="keywordtype">double</span> insideAcos = (z - 1.) / p;
<a name="l00248"></a>00248                 <span class="keywordtype">double</span> firstTerm = <a class="code" href="namespaceanonymous__namespace_02_generate_model_8cpp_03.html#a4a2249f2dca60f8b089f49900273e4df" title="Square function.">square</a>(p) * acos(insideAcos);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250                 F = 1. - (integral * (firstTerm - sqrtVal) / (4. * M_PI * omega));
<a name="l00251"></a>00251             }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254         <span class="keywordflow">else</span>
<a name="l00255"></a>00255         {
<a name="l00256"></a>00256             F = 1.;
<a name="l00257"></a>00257         }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 
<a name="l00260"></a>00260         <span class="comment">// append the data to the vectors</span>
<a name="l00261"></a>00261         <span class="comment">//lc.jd[i] = t / secondsInDay + midpoint;</span>
<a name="l00262"></a>00262         <span class="comment">//lc.flux[i] = F;</span>
<a name="l00263"></a>00263         Flux.push_back(F);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266     <span class="comment">//outfile.close();</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="comment">//lc.radius = rPlan / rJup;</span>
<a name="l00269"></a>00269     <span class="comment">//return lc;</span>
<a name="l00270"></a>00270     <span class="keywordflow">return</span> Flux;
<a name="l00271"></a>00271 }
<a name="l00272"></a>00272 
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Nov 4 2011 17:19:26 for Model generation by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
